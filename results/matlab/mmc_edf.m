%  M/M/c WITH DEADLINES + EDF â€“ PLOTTING SCRIPT
%
%  This script reads the CSV file generated by mmc_edf.java and
%  plots:
%     - Ns (simulation)
%     - Nq (simulation)
%     - Ds (simulation)
%     - Dq (simulation)
%     - Utilization
%     - Probability of serving expired tasks
%
%  Make sure the CSV file path matches your Java output.
% =============================================================

% clear; clc; close all;

% ======================
%  Load CSV
% ======================
csv_file = '../csv/mmc_edf.csv';  
T = readtable(csv_file);

rho        = T.rho;

Ns_sim     = T.Ns_sim;  
Nq_sim     = T.Nq_sim;  
Ds_sim     = T.Ds_sim;  
Dq_sim     = T.Dq_sim;  
util_sim   = T.utilization_sim;
pExpired   = T.pExpired_sim;

% ======================
%  Helper plotting function
% ======================
function make_plot(x, y1, ttl, ylab)
    figure; hold on; grid on;
    plot(x, y1, 'bo-', 'LineWidth', 1.6, 'MarkerSize', 6);
    legend('Simulation', 'Location','best');
    xlabel('\rho'); 
    ylabel(ylab);
    title(ttl);
end

% ======================
%  PLOTS
% ======================

% ---- Ns ----
make_plot(rho, Ns_sim, 'Average Number in System (Ns)', 'Ns');

% ---- Nq ----
make_plot(rho, Nq_sim, 'Average Number in Queue (Nq)', 'Nq');

% ---- Ds ----
make_plot(rho, Ds_sim, 'Average System Delay (Ds)', 'Time');

% ---- Dq ----
make_plot(rho, Dq_sim, 'Average Queueing Delay (Dq)', 'Time');

% ---- Utilization ----
make_plot(rho, util_sim, 'Server Utilization', 'Utilization');

% ---- Probability of serving expired tasks ----
make_plot(rho, pExpired, 'P(Expired Task Served)', 'Probability');

disp('All EDF plots generated successfully.');
